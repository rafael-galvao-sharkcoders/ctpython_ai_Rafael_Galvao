import tkinter as tk
import subprocess
from os import waitpid

import pyautogui as auto
import speech_recognition as sr
import pyttsx3
import subprocess
from time import sleep
from tkinter import *
import pydub
from pydub import AudioSegment
from pydub.playback import play

# Play some music.
#task_success = AudioSegment.from_mp3("success.mp3")


recognizer = sr.Recognizer()
engine = pyttsx3.init()

screen = tk.Tk()
screen.title('J.A.R.V.I.S')
screen.geometry('800x550+560+300')
screen.wm_resizable(width=False, height=False)

# As funções que fazem o bot.

def speak(text):
    engine.say(text)
    engine.runAndWait()

def listen():
    with sr.Microphone() as source:
        recognizer.adjust_for_ambient_noise(source)  # Ajusta para o ruído ambiente
        audio = recognizer.listen(source)  # Escuta a fala
        try:
            # Usa o Google Web Speech API para reconhecer o áudio
            text = recognizer.recognize_google(audio)
        except sr.UnknownValueError:
            return ""
        except sr.RequestError as e:
            return ""

def main():
    speak("I am Jarvis, your personal A.I. Assistant! How may i help you?")
    while True:
        text = listen()


        if "Open browser" in text.lower():
            speak("Understood! Please stand by!")
            sleep(1)
            subprocess.Popen(["C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\msedge.exe"])
            #play(task_success)
            sleep(1)
            speak("Browser open now! Anything else i can help you with?")

        elif "No" or "No, thank you" in text.lower():
                exit()

        else:
            sleep(20)
            speak("I am getting impatient. Please say something!")




# Ativar o bot.
Button_1 = tk.Button(screen, text='Speak', command=main, font=('Times', 16, 'bold'))
Button_1.place(width=175, height=75, x=300, y=190)







screen.mainloop()
